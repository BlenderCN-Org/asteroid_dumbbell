import numpy as np
import utilities

class TestIsmember():
    a = np.array([[4, 6,5],[2, 6,5],[5, 2,5]])
    b = np.array([[1, 7,5],[1, 8,5],[2, 6,5],[2, 1,5],[2, 4,5],[4, 6,5],[4, 7,5],[5, 9,5],[5, 2,5],[5, 1,5]])

    e1 = np.array([
        [0.1699,  -0.5125,    0.1174],
       [ 0.9061 ,   0.1447,   -0.0347],
       [ 0.3551 ,   0.0509,    0.0354],
       [-0.0084 ,  -0.0043,    0.2267],
       [-0.1699 ,   0.5125,   -0.1174],
       [-0.2387 ,   0.7701,    0.0069],
       [ 0.4116 ,  -0.0502,    0.1015],
       [-0.4111 ,  -0.0607,    0.6044],
       [ 0.2265 ,  -0.0626,   -0.4776],
       [ 0.4234 ,   0.1950,   -0.1898],
       [ 0.3488 ,  -0.3244,   -0.0425],
       [ 0.5354 ,   0.1438,    0.3628],
       [-0.3187 ,  -0.2292,   -0.0676],
       [ 0.1753 ,  -0.4015,   -0.5248],
       [ 0.3103 ,   0.2250,    0.2943],
       [-0.8864 ,  -0.0124,   -0.3669],
       [-0.1223 ,   0.2617,   -0.4351],
       [ 0.2471 ,  -0.1577,    0.0844],
       [-0.1753 ,   0.4015,    0.5248],
       [-0.4116 ,   0.0502,   -0.1015],
       [-0.4234 ,  -0.1950,    0.1898],
       [ 0.2387 ,  -0.7701,   -0.0069],
       [ 0.6881 ,  -0.3969,   -0.0197],
       [ 0.1721 ,  -0.0545,   -0.1507],
       [ 0.9202 ,   0.0801,   -0.2273],
       [-0.3375 ,  -0.4851,    0.0503],
       [ 0.3375 ,   0.4851,   -0.0503],
       [ 0.2229 ,   0.1466,   -0.0616],
       [ 1.0076 ,   0.1585,    0.1287],
       [ 0.2390 ,  -0.4270,   -0.0119],
       [ 0.5677 ,  -0.2169,    0.2993],
       [ 0.2116 ,   0.4595,    0.1278]])

    e1_ind1a = np.array([
         1,
         0,
         0,
         0,
         1,
         1,
         1,
         0,
         0,
         1,
         0,
         0,
         0,
         1,
         0,
         0,
         0,
         0,
         1,
         1,
         1,
         1,
         0,
         0,
         0,
         1,
         1,
         0,
         0,
         0,
         0,
         0])

    e1_ind1b = np.array([
         5,
         0,
         0,
         0,
         1,
        22,
        20,
         0,
         0,
        21,
         0,
         0,
         0,
        19,
         0,
         0,
         0,
         0,
        14,
         7,
        10,
         6,
         0,
         0,
         0,
        27,
        26,
         0,
         0,
         0,
         0,
         0])

    def test_in1d_index(self):
        indx = utilities.in1d_index(self.a,self.b)
        np.testing.assert_allclose(np.array([2,5,8]),indx)

    def test_ismember_rows(self):
        indx = utilities.ismember_rows(self.a,self.b)
        np.testing.assert_allclose(np.array([5,2,8]),indx)

    def test_ismember_index(self):
        indx = utilities.ismember_index(-self.e1,self.e1)

        np.testing.assert_allclose(indx, self.e1_ind1b -1)


